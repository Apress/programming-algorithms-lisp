(in-package :progalgs)


(defstruct node
  id edges)

(defstruct edge
  src dst label)

(defstruct (graph (:conc-name nil) (:print-object pprint-graph))
  (nodes (make-hash-table)))  ; mapping of node ids to nodes

(defun pprint-graph (graph stream)
  (let ((ids (sort (rtl:keys (nodes graph)) '<)))
    (format stream "窿ア殇螬桢蝈葬轶躞邃骘箴徙ㄤ镬轶ㄩ浔殇螬戾è铒溴螋旌珧狃ь镤弩殇暴┅ㄦ矧磲篝蝈犴立殇暴ㄤ镬轶ㄩ洳殇螬ㄦ矧磲篝蝈犴痕圾茛桢蝈葬狍麇祆ㄦ轭殇螋旌铒溴у溏弩弘妁у溏瀛潴舂┅翦蝠蜷篝蝈犴┅┅ㄤ彐躅轭轸珧狃ㄥ溏弩螋旌鏖翳è蝈磲脲珧狃瑭铒溴铒溴蝈┅祜镳烘矧篁潴舂洪邃珏轰戾è篁悱铒溴螋旌珏趔弭栳箬篁铒溴磲脲铒溴洪篁悌┅螋旌珏趔弭潴铒溴磲脲铒溴洪潴舂瘐箬磲脲邃珏后蜚篁轰篝潴舂螋旌篁悱铒溴у溏弩┅┅蝈┅ㄤ彐翦篝珧狃ī箬秕熹痱轭舡麸篝犷溽蜾秕麴豸痱轭ㄩ铋舡珧狃Жǚ俯ū畅ū博ǔ穿ǔ旦ú穿ú旦ǖ穿ǖ订ù订┅┅ㄤ彐躅麸痫箫螋ㄧ蜥痂戾è铒溴铒溴珧狃瑭鲩箝翦磲脲栳箬翎忪濠蝈螋旌鲥悌┅螋旌滹膂ㄩ铒溴铒溴螬躅戾篌ㄧ弭栳箬殇鲩箝翦洎鲩箝铒溴铒溴鲩箝翦蝈┅蝈┅ㄤ彐躅鲩箝铒溴铒溴鲩箝翦蝈ㄤ镬轶ㄥ溏铒溴邃珏铒溴┅螋旌鏖翳è殇ㄥ溏瀛潴邃珏┅ㄣ栝熹ㄧ弭栳箬殇铒溴螬┅躅戾篌ㄦ轭殇蝈ㄡ篌弪铒ㄧ弭栳箬殇鲩箝翦洎铋⒃桢珧狃轶瞌徙沆殂骘鲥螋屮立殇箦翩ㄧ弭栳箬殇鲩箝翦洎舂鲩箝汨殪铒溴鲩箝翦蝈┅┅鲥泗矧瘐箬屮翦钿铒溴殇铒溴蝈蝈ㄤ彐翦篝麸痫箫螋ī箬秕熹忮羼踽祓（暴麸痫箫螋ㄩ铋舡珧狃Жǚ俯ū畅ū博ǔ穿ǔ旦ú穿ú旦ǖ穿ǖ订ù订┅┅ㄤ彐鲠桢狃轭溟沐螵ㄤ彐躅痱轫眢ㄧ蜥痂戾è轭轸獒飙麇殓梏扉篝┅眢扉篝┅麸翎癌í桢狃轭溟沐螵磲脲栳箬翎忪濠麇殓梏邃珏沲颟螋旌滹膂ㄩ铒溴铒溴珧狃瑭ㄩ沲瘐箬螋旌疳轵殇矧ㄥ祠邃珏殇换篝犷溽蜾泔铙翎铘翳狒轶换顼镤孱秕玷篚怏糸趱翦骘轭骈铋豉盹篝痫箝糸鲥骈铛愆轭轸獒飙麇殓梏螬箦翩沲殇邃珏铒溴邃珏铒溴┅┅箦翩麇殓梏ㄨ遽痖纟轭轸獒飙麇殓梏螬祜镳螋旌鏖翳èㄩ麇殓梏ㄨ遽瓠痫麇殓梏螬┅躅戾篌殇蝈趱蝾┅麒孱ㄥ祠邃珏殇换殒铒衄麇栳鲥盹鲥麸翳铄泔铑邈翦泔眇镱孱换箫翳弪濮铒邃珏泔铑邈糸铉轸麸翳痱弼轱躞镱瘐箬螋旌疳轵沲殇眢舂ㄩ钽麸翎麇殓梏┅螋旌滹膂ㄩ邃珏螬麒孱麇殓梏ㄨ遽瓠溴泸遽箦脲麇殓梏殇鳗┅箦翩沲殇邃珏螋旌珧狃ь镤弩殇у溏弩┅┅鲠祯弩眢麸翎飑┅ㄤ彐躅桢狃滹黝鲥忮镳糸镱犰ㄥ钿戾铉翳鲥悌┅戾èㄨ祠忮绌ㄨ螋忮绌┅麒孱孱洎戾è汨殪ㄩ矧窘孱洎ㄡ蝈鲥飑ㄡ蝈鲥颟┅颟┅麒孱ㄡ蝈鲥汨殪洎ㄡ蝈鲥忮绌蝻翎翦ㄧ弭栳箬ㄡ蝈鲥忮绌桢狃轭溟沐螵ㄧ弭栳箬ㄡ蝈鲥汨殪洎桢狃轭溟沐螵┅蝻翎翦ㄡ蝈鲥忮绌ㄡ蝈鲥汨殪洎ㄨ遽瓠滹黝鲥汨殪孱洎┅┅鲥悌ㄤ彐躅桢狃溴泸遽箦脲鲥脲溴泸屙孱舂戾è痫ㄧ弭栳箬脲桢狃轭溟沐螵┅┅躅戾篌ㄥ蝌矧⑽脲骘躅轭翳桢狃立脲鲥悌麒孱铛祆ㄧ弭栳箬脲桢狃轭溟沐螵┅蝈龛狍脲桢狃轭溟沐螵┅瘐箬ㄧ弭栳箬ō脲溴泸屙孱舂桢狃轭溟沐螵┅ㄤ邈ㄡ蝈鲥椹溴泸屙孱舂ㄨ遽瓠躔鲥椹┅ㄤ彐躅桢狃躔鲥椹螋旌鏖翳è榄脲ㄡ蝈鲥椹疳蝈铘ㄨ疳蝈铘椹疳蝈铘脲ㄡ蝈鲥疳蝈铘┅麒孱榄脲疳蝈铘脲螋旌蝈盹鲥ㄧ弭栳箬榄脲桢狃轭溟沐螵椹螋旌蝈盹鲥ㄧ弭栳箬疳蝈铘脲桢狃轭溟沐螵疳蝈铘瘐箬ㄧ弭栳箬疳蝈铘脲桢狃轭溟沐螵┅瘐箬疳蝈铘ㄧ弭栳箬榄脲桢狃轭溟沐螵┅蝻翎翦ㄡ蝈鲥椹ㄡ蝈鲥疳蝈铘┅ㄨ遽瓠躔鲥疳蝈铘┅鲥悌ㄤ彐躅桢狃躔泔蝌邈鲥椹戾è疳蝈铘ㄨ疳蝈铘椹┅麒孱ㄡ蝈鲥椹ㄡ蝈鲥疳蝈铘┅蝻翎翦ㄧ弭栳箬ㄡ蝈鲥椹桢狃轭溟沐螵ㄧ弭栳箬ㄡ蝈鲥疳蝈铘桢狃轭溟沐螵┅蝻翎翦ㄡ蝈鲥椹ㄡ蝈鲥疳蝈铘┅ㄨ遽瓠躔鲥疳蝈铘┅鲥悌ㄤ彐躅桢狃溴泸遽箦脲泔蝌邈鲥脲溴泸屙孱舂戾èㄧ弭栳箬脲桢狃轭溟沐螵┅躅戾篌ㄥ蝌矧⑽脲骘躅轭翳桢狃立脲鲥悌蝈龛狍脲桢狃轭溟沐螵箦翩ㄧ弭栳箬ō脲溴泸屙孱舂桢狃轭溟沐螵椹ㄤ邈ㄡ蝈鲥椹溴泸屙孱舂ㄨ遽瓠躔鲥椹┅ㄤ彐篝蝓泗桢狃轸屙脲鲠飑ㄤ彐躅桢狃躔鲥椹螋旌鏖翳è榄脲ㄨ遽瓠轸屙脲ㄡ蝈鲥椹┅疳蝈铘ㄨ疳蝈铘椹疳蝈铘脲ㄨ遽瓠轸屙脲ㄡ蝈鲥疳蝈铘┅┅麒孱榄脲疳蝈铘脲螋旌蝈盹鲥ㄧ弭栳箬榄脲桢狃轭溟沐螵椹螋旌蝈盹鲥ㄧ弭栳箬疳蝈铘脲桢狃轭溟沐螵疳蝈铘瘐箬ㄧ弭栳箬疳蝈铘脲桢狃轭溟沐螵┅瘐箬疳蝈铘ㄧ弭栳箬榄脲桢狃轭溟沐螵┅蝻翎翦ㄡ蝈鲥椹ㄡ蝈鲥疳蝈铘┅ㄨ遽瓠躔鲥疳蝈铘┅鲥悌换韵南翦篝桢狃ㄤ彐篝蝓泗箴姝铒溴ê轭沆蹁铒溴┅麇殓梏盹篝痫箝糸鲥骈铛愆疳翳扉篝┅ㄤ彐躅箴ㄧ蜥痂篁潴舂螋旌鏖翳è铒溴ㄧ蜥痂铒溴珧狃瑭换翳骘祆秣轭泔溴箬秕熹屮痱弩轭轸獒扉翳桢狃换鏖翳箝铉戾铒溴镦麇殓梏犷犰雉桢铒溴换镦麇殓梏拖釉邢由陨峙粕匚胀换ㄩ铙翦徜镦蝓铑轭熄瞠祜瞟扰列善侃麇殓梏ㄩ铋舡麇殓梏蟓桢狃铒溴篁悌┅祜镳螋旌鏖翳èㄩ麇殓梏ㄨ遽瓠痫麇殓梏螬┅ㄣ镱è羼殇潴舂戾è潴ㄥ祠铒溴潴舂┅换麇蝈趱蝾赭鲠祯弩翳疳翳犷轸戾铉翳蝈趱蝾鲠祯弩ㄣ镱潴箴姝铒溴疳翳潴舂箴姝铒溴麇殓梏潴舂┅┅è盹篝痫箝糸鲥骈铛麇殓梏蝈趱蝾┅铒疳翳屮轶趔ㄤ镬轶ㄥ溏螋旌铒溴殇у溏弩┅螋旌鏖翳è沲ㄥ溏瀛潴邃珏┅铒溴ㄥ祠铒溴沲颟ǐ麇殓梏箴姝铒溴麇殓梏沲颟┅麒孱箴姝铒溴麇殓梏铒溴┅ㄨ遽瓠溴泸遽箦脲麇殓梏沲鳗箦翩箴姝铒溴麇殓梏铒溴箴姝铒溴疳翳铒溴ㄣ镱螋旌铒溴殇螋旌铒溴殇ю狒瑭┅┅┅┅换韵南翦篝箴ㄤ彐篝蝓泗礞邃珏忮孱汜疳汩豉ㄤ彐躅磲骒秣ㄧㄡ篌弪ㄡ蝌狴溟礤铙轱癌ㄡ蝌狴溟礤铙轱暴┅戾è蜱螋旌泔瘗狎蜥绌蝈箝漉犰珧狃蝈癌祜镳烘矧疳翳航ㄡ蹒疳翳蜱瑚栝戾疳翳轰戾è骒秣盹篝痫箝糸鲥骈铛愆换翳骒秣犰镱翳疳翳轶翳蝈箝漉犰汜疳汩豉镦翳翳轭铄篝邃珏ㄤ镬轶ㄥ溏疳翳戾è汜礞邃珏汜疳汩豉邃珏┅麒孱ㄡ怏汜皓骒秣箦翩骒秣ㄡ怏汜皓┅┅ㄤ镬轶ㄥ溏疳翳鏖翳箪雉ㄢ彗孱洎邃珏ㄤ邈ㄡ蝈蜱忮孱洎骒秣ㄩ钽ㄡ蝈蜱孱忮绌骒秣┅ㄩ钽蝈骒秣┅蝈┅ㄤ彐躅狨绛疳翳ㄧ螋旌鏖翳è箝铍ūㄡ蝌狴溟礤铙轱癌┅鲩箝翦磲脲狎蜥ū箝铍洪铋糸犰屐屙孱铋飑┅灬忮祗è滏ㄧ椹箦翩ㄡ蝈鲩箝翦椹舂ㄩ弪镳ㄡ蝈箝铍┅ㄤ雉轫弩箝铍躅戾篌矧弪镳ㄡ蝈戛ㄡ蝈鲩箝翦戛螋旌麒孱轸ㄤ骟戛蝈趱蝾ㄣ镱磲脲礞邃珏衡彗哄钿恒狃徙轸ㄡ蝈戛螋旌轸┅┅扉篝磲脲礞邃珏衡彗哄钿箝铍恒狃徙轸ㄡ蝈箝铍┅┅┅ㄤ骟癌┅ㄤ彐翦篝磲骒秣ī箬秕熹忮磲骒秣２哩ò癌ò癌ò癌ò畅ò旦ò癌┅┅换泔溴痱雉雉疱ㄤ彐躅疳珏蜥铍ㄧ脲ㄤ爱傅蝈疱狒卑癌螋旌鏖翳è铒溴铒溴绌戾铉翳铒溴螬痱磲脲狎蜥洪铋糸犰屐屙孱ǒ瞟┅祜镳候屦遽蝈疱狒轰戾è痱磲鲥泗矧灬礅溽ōǒ瞟┅痱┅螋旌滹膂ㄩ铒溴铒溴螬戾èㄡ蝈痱椹戾铉翳铒溴汨殪潋孱铒溴┅┅螋旌滹膂铒溴汨殪潋孱铒溴┅ㄩ钽ㄡ蝈痱戛íǒ愆┅┅箦翩痱痱博┅痱┅ㄤ彐躅痱铒溴脲ㄤ爱傅┅戾è痱磲脲狎蜥洪铋糸犰屐屙孱癌ㄨ狍璀翎忪瀛泔躅铒溴汨殪潋孱铒溴┅┅螋旌滹膂汨殪铒溴汨殪潋孱铒溴┅箦翩ㄡ蝈痱戛íǒ愆┅痱┅ㄤ彐躅疳珏蜥铍眚ㄧ脲ㄤ爱傅蝈疱狒卑癌螋旌鏖翳è戾铉翳铒溴绌┅痱磲脲狎蜥洪铋糸犰屐屙孱ǒ瞟┅祜镳候屦遽蝈疱狒轰箦翩痱磲鲥泗矧灬礅溽ōǒ瞟┅蝈漉沐鲥惬磲鲥泗矧灬礅溽铒溴皓痱铒溴轰洎铒溴绌痱┅┅痱┅